// Having added test AlephZero chain with `papi add`
import { contracts, MultiAddress, testAzero } from "@polkadot-api/descriptors"
import { getInkClient } from "polkadot-api/ink"
import { Binary, createClient, Enum } from "polkadot-api"
import { withPolkadotSdkCompat } from "polkadot-api/polkadot-sdk-compat"
import { getWsProvider } from "polkadot-api/ws-provider/node";
import { readFileSync } from 'fs';
import { addressOf, addressOfAlephZero, buildAccount, publicKeyOf } from "../../config/account"
import { makeRemark, submit } from "../../config/calls";
import { magicApi } from "../../config/api";

const client = createClient(
  withPolkadotSdkCompat(
    getWsProvider("wss://aleph-zero-testnet-rpc.dwellir.com"),
  ),
)


const erc721Client = getInkClient(contracts.erc721)

// typedAPI for test AlephZero
const typedApi = client.getTypedApi(testAzero)

const myAccount = addressOfAlephZero(publicKeyOf())
console.log('My account:', myAccount)

let contractAddress = '';


const wasmBlob = "0061736d01000000013e0b60027f7f0060037f7f7f0060027f7f017f60037f7f7f017f60017f0060000060047f7f7f7f017f60047f7f7f7f0060017f017f60037e7e7f006000017f02e0010b057365616c310b6765745f73746f726167650006057365616c3005696e7075740000057365616c300d6465706f7369745f6576656e740007057365616c320b7365745f73746f726167650006057365616c310d636c6561725f73746f726167650002057365616c3110636f6e7461696e735f73746f726167650002057365616c300b7365616c5f72657475726e0001057365616c300663616c6c65720000057365616c301176616c75655f7472616e736665727265640000057365616c300f686173685f626c616b65325f323536000103656e76066d656d6f727902010210033d3c030303030300010000000000000400080200000104010000000000000100000009040100040a040202010102010001000501040200000005020305010616037f01418080040b7f0041b084050b7f0041a484050b0711020463616c6c0041066465706c6f7900440afb653c2b01017f037f2002200346047f200005200020036a200120036a2d00003a0000200341016a21030c010b0b0b6f01017f0240200020014d04402000210303402002450d02200320012d00003a0000200341016a2103200141016a2101200241016b21020c000b000b200041016b2103200141016b210103402002450d01200220036a200120026a2d00003a0000200241016b21020c000b000b20000b2501017f037f2002200346047f200005200020036a20013a0000200341016a21030c010b0b0b3f01027f0340200245044041000f0b200241016b210220012d0000210320002d00002104200141016a2101200041016a210020032004460d000b200420036b0b8c0101017f20002d00042103200041003a0004027f0240200345044041012000280200220028020422032002490d021a2001200028020022012002100a1a0c010b200120002d00053a00004101200028020022002802042203200241016b2202490d011a200141016a200028020022012002100a1a0b2000200320026b3602042000200120026a36020041000b0b0c00200020014180800410450bff0101047f230041106b22032400200342808001370208200341a4840436020420012002200341046a22061026024020032802082204200328020c2201490d00200328020421022003200420016b220536020420022001200120026a2204200610002102200520032802042205492002410f4f720d004100210102402002418582046a2d000022024103460d0020024110470d0141012101200041016a21022005412046044020022004290000370000200241186a200441186a290000370000200241106a200441106a290000370000200241086a200441086a2900003700000c010b200241103a0000410221010b200020013a0000200341106a24000f0b000bd70101047f230041206b22022400200242808001370218200241a484043602142001200241146a22051012024020022802182204200228021c2201490d00200228021421032002200420016b220436021420032001200120036a2203200510002101200420022802142204492001410f4f720d002000027f2001418582046a2d0000220141034604404100210341100c010b20014110470d012002200436021820022003360214200241086a200241146a101320022802080d0141012103200228020c0b36020420002003360200200241206a24000f0b000b1000418480042001102520002001101c0b3e01027f230041106b22022400200241086a20011022200228020821032000200228020c36020420002003200128020472410047360200200241106a24000b0c00200020014188800410450b8c0101047f230041106b22022400200242808001370208200241a484043602042000200241046a22041012024020022802082205200228020c2200490d00200228020421032002410036020c2002200520006b3602082002200020036a360204200120041016200228020c220120022802084b0d00200320002002280204200110031a200241106a24000f0b000b2601017f230041106b220224002002200036020c20012002410c6a4104101f200241106a24000b0a0041888004200010180b4c01017f230041106b22022400200242808001370208200241a4840436020420002001200241046a1026200228020c220020022802084b0440000b2002280204200010041a200241106a24000b0d00418880042000101a4100470b4f01017f230041106b22022400200242808001370208200241a4840436020420002001200241046a1026200228020c220020022802084b0440000b20022802042000103d2100200241106a240020000ba90101057f230041306b2202240002402000280204220420002802082203490d00200028020021052002410036020c2002200420036b22043602082002200320056a22053602042001200241046a2206101c200228020c220120022802084b0d00200620022802042001101d2002410036022c20022004360228200220053602242006200241246a101c2003200228022c6a22012003490d0020002001360208200241306a24000f0b000b0a00200120004120101f0bed0101077f230041406a22032400200341186a22044200370300200341106a22054200370300200341086a22064200370300200342003703000240200241214f0440200341386a22074200370300200341306a22084200370300200341286a220942003703002003420037032020012002200341206a1009200420072903003703002005200829030037030020062009290300370300200320032903203703000c010b200320012002100a1a0b20002003290300370000200041186a200341186a290300370000200041106a200341106a290300370000200041086a200341086a290300370000200341406b24000bb40101077f230041306b2201240002402000280204220320002802082202490d00200028020021042001410036020c2001200320026b22033602082001200220046a2204360204200141003a0024200141046a2205200141246a22064101101f200128020c220720012802084b0d00200520012802042007101d2001410036022c200120033602282001200436022420052006101c20022002200128022c6a22024b0d0020002002360208200141306a24000f0b000b4801027f024002402000280208220320026a22042003490d00200420002802044b0d00200420036b2002470d01200028020020036a20012002100a1a200020043602080f0b000b000b6b01047f230041106b2202240002402000280204220420002802082203490d00200028020021052002410036020c2002200420036b3602082002200320056a3602042001200241046a10212003200228020c6a22012003490d0020002001360208200241106a24000f0b000b7401017f230041106b2202240002402000413f4d04402001200041027410400c010b200041ffff004d0440200220004102744101723b010e20012002410e6a4102101f0c010b200041ffffffff034d04402000410274410272200110160c010b2001410310402000200110160b200241106a24000b4601017f20012802042202410449047f4101052001200241046b36020420012001280200220141046a3602002001280000210241000b210120002002360204200020013602000ba30101037f230041106b22032400410121040240200128020422024120490d002001200241206b36020420012001280200220241206a360200200341086a2001102220032802080d00200328020c210120002002290000370004200020013602242000411c6a200241186a290000370000200041146a200241106a2900003700002000410c6a200241086a290000370000410021040b20002004360200200341106a24000b1d0020002802002001102520002802042001101c20002802082001101c0b0b002000280200200110160b0e002000200210252001200210160b1400200028020020011025200041046a2001101c0b3c01017f200020012802042202047f2001200241016b36020420012001280200220141016a36020020012d00000520010b3a000120002002453a00000b2601017f230041106b22022400200220003a000f20012002410f6a4101101f200241106a24000b2a01017f230041106b220324002003200137030820032000370300200220034110101f200341106a24000b970201047f230041f0006b220124002001410c6a2202200041c800100a1a200142808001370258200141a4840436025420012002360260200141d4006a220041041020200041a38104101b024020012d001004402000200141116a101b0c010b200141d4006a101e0b024020012d00310440200141d4006a200141326a101b0c010b200141d4006a101e0b200141e4006a2202200141d4006a200141e0006a102c024020012802682203200128026c2200490d00200128026421042001410036026c2001200320006b3602682001200020046a360264200141106a2002102d200141316a2002102d200128020c20021016200128026c220320012802684b0d0020042000200128026420031002200141f0006a24000f0b000bd40101057f230041306b2203240002400240200204402001280204220520012802082204490d02200128020021062003410036020c2003200520046b22053602082003200420066a22063602042002280200200341046a22071025200328020c220220032802084b0d02200720032802042002101d2003410036022c20032005360228200320063602242007200341246a101c2004200328022c6a22022004490d02200120023602080c010b2001101e0b20002001290200370200200041086a200141086a280200360200200341306a24000f0b000b210020002d00004504402001410010400f0b200141011040200041016a2001101c0b850101027f230041106b2201240020014180800136020c41a484042001410c6a1007200128020c2202418180014f2002411f4d72450440200041a58404290000370001200041096a41ad8404290000370000200041116a41b58404290000370000200041186a41bc8404290000370000200041a484042d00003a0000200141106a24000f0b000b3602017f027e230041106b2200240020001030200041086a290300210120002903002102200041106a2400410541042001200284501b0b6002027f017e230041206b22012400200141106a22024200370300200142003703082001411036021c200141086a2001411c6a1008200128021c41114f0440000b200129030821032000200229030037030820002003370300200141206a24000b0b002000200110324101730b0b00200020014120100d450b5101027f230041106b22032400200341046a20024100103820032802040440000b20032802082104200328020c20012002100a2101200020023602082000200136020420002004360200200341106a24000b0a0020002001200210330b6a01017f230041206b22022400200220013602102002200036020c2002418c8004360208200242808001370218200241a48404360214200241086a200241146a1024200228021c220020022802184b0440000b20022802142000103d2100200241206a240020004100470b1000200120021021200220002001101f0bc10701097f230041206b22032400200341086a2001102802400240024020032d00080d000240024002400240024020032d0009220241037141016b0e03010203000b200241fc017141027621020c030b200320023a0019200341013a001820032001360214200341003b0110200341146a200341106a4102100e0d0320032f0110220241ff014d0d03200241027621020c020b200320023a0019200341013a00182003200136021420034100360210200341146a200341106a4104100e0d022003280210220241808004490d02200241027621020c010b200241044f0d0120032001102220032802000d0120032802042202418080808004490d010b20012802042002490d00200341146a2002410110382003280214450440200128020422062002490d0120032802182108200328021c200128020022042002100a21052001200620026b3602042001200220046a3602002008418080808078460d012002450d02200241076b22014100200120024d1b2109200541036a417c7120056b210a41002101034002400240024002400240024002400240024002400240200120056a2d00002206411874411875220741004804402006419482046a2d000041026b0e03030102080b200a20016b4103710d09200120094f0d080340200120056a220641046a280200200628020072418081828478710d092009200141086a22014b0d000b0c080b200141016a220420024f0d06200420056a2c000021040240200641e001470440200641ed01460d012007411f6a41ff0171410c490d042007417e71416e470d0820044140480d050c080b200441607141a07f460d040c070b2004419f7f4a0d060c030b200141016a220420024f0d05200420056a2c000021040240024002400240200641f0016b0e050100000002000b2007410f6a41ff017141024b0d0820044140480d020c080b200441f0006a41ff01714130490d010c070b2004418f7f4a0d060b200141026a220620024f0d05200520066a2c000041bf7f4a0d05200141036a220120024f0d05200120056a2c000041bf7f4c0d040c050b200141016a22012002490d020c040b200441404e0d030b200141026a220120024f0d02200120056a2c000041bf7f4c0d010c020b200120056a2c000041bf7f4a0d010b200141016a21010c030b20004180808080783602000c070b200120024f0d010340200120056a2c00004100480d022002200141016a2201470d000b0c050b200141016a21010b20012002490d000b0c020b000b20004180808080783602000c010b2000200236020820002008ad2005ad422086843702000b200341206a24000bb40201027f2000027f024002400240200145044020004280808080103702040c010b200141004e2204450440200041003602040c030b2002450440419484042d00001a0b02400240027f419884042d00000440419c84042802000c010b3f002103419c840441b084053602004198840441013a000041a08404200341107436020041b084050b2202200120026a22034b0d00200341a084042802004d0d01200141ffff036a220341107640002202417f460d002002411074220220034180807c716a22032002490d0041a084042003360200200120026a220320024f0d010b200041086a2103200041046a21000c020b419c84042003360200200041086a2103200041046a21002002450d0120032002360200200020013602000b41000c020b20032001360200200020043602000b41010b3602000b4401027f41a4840441003a000041012103200141ff0171410947044041a5840441013a000041022103200121020b200341a484046a20023a00002000200341016a103e000b130041a484044181023b010041014102103e000b8e0101037f230041106b22032400200342808001370208200341a4840436020420002001200341046a22041026024020032802082205200328020c2200490d00200328020421012003410036020c2003200520006b3602082003200020016a36020420022004101c200328020c220220032802084b0d00200120002003280204200210031a200341106a24000f0b000bb30101057f230041106b22012400200142808001370208200141a484043602044100200141046a22021016024020012802082205200128020c2203490d00200128020421042001410036020c2001200520036b3602082001200320046a360204200028021420002802182002103620002802202000280224200210362000290300200041086a2903002002102a200128020c220020012802084b0d00200420032001280204200010031a200141106a24000f0b000b0b00200020011005417f470b0d00200041a4840420011006000b980101017f230041106b22022400200220011028024002400240024020022d000045044020022d00010e020203010b20004181808080783602000c030b20004181808080783602000c020b20004180808080783602000c010b200241046a200110372002280204220141808080807847044020002002290208370204200020013602000c010b20004181808080783602000b200241106a24000b2d01017f2000280208220220002802044904402000200241016a360208200028020020026a20013a00000f0b000b8532020c7f067e230041b0036b220024002000418080013602d80241a48404200041d8026a10010240024002400240024002400240024002400240027f024002400240024020002802d8022201418180014f0d0020014104490d0a200041a884043602682000200141046b220636026c41a48404280200220241187621052002411076210320024108762104027f02400240024002400240024002400240024002400240024002400240024002400240200241ff01712202410b6b0e05051c1c1c01000b20024127460d02200241d000460d05200241d500460d03200241db00460d06200241e800460d08200241f200460d0b2002418401460d092002419901460d01200241b101460d0a200241cf01460d07200241ec0147200541ee014772200441ff017141c00047200341ff0171413d4772720d1b200041d8026a200041e8006a103f20002802d8022202418180808078460d1b20003500dd02200041e3026a310000423086200041e1026a3300004220868484210d20002d00dc02210141080c100b200441ff0171220241d900460d0b200241f50047200341ff017141da004772200541d600472006411f4d72720d1a200041a8016a41c784042d00003a0000200041bf84042900003703a00141b78404290000220e42388641af8404290000220c42088884210d41ab8404280000210241a984042f0000210841a884042d00002109200ca7210141000c0f0b2005411e47200441ff017141f2004772200341ff0171410c47200641044972720d19200041ac840436026841a88404280200210241010c0e0b200541ea0147200441ff017141d9004772200341ff0171412d47200641044972720d18200041ac840436026841a88404280200210241020c0d0b200541d60147200441ff017141cd014772200341ff017141ac0147720d1741040c0c0b200441ff01712202412f460d082002413947200341ff017141ef00477220054118472006411f4d72720d16200141c4006b2201415f4b2001410449720d1641b48404290200210e41ac8404290200210c41c684042f0100210341c584042d0000210441a88404280200210241c884042802002106200041a8016a41c484042d00003a000020004190026a41d4840429020037030020004198026a41dc8404290200370300200041a0026a41e48404280200360200200041ec8404360268200041bc84042902003703a001200041cc840429020037038802200e423886200c42088884210d200ca7210141e884042802002107410c0c0b0b200541820147200441ff0171411d4772200341ff017141af0147200641104972720d15200041b8840436026841b08404290200220e42388641a88404290200220c42088884210d200ca7210141060c0a0b200541ea0047200441ff017141e4004772200341ff017141e60147200641044972720d14200041ac840436026841a88404280200210241070c090b200441ff0171220241d001460d06200241dd0147200341ff0171419a014772200541a20147200641044972720d13200041ac84043602682000200141086b36026c41a884042802002102410d0c080b200541a00147200441ff017141124772200341ff017141e60047720d12200041d8026a200041e8006a102320002802d8020d12200041a8016a200041f8026a2d00003a0000200020002902f0023703a001200041e8026a290200220e42388620002902e002220c42088884210d20002802dc02210220002d00f902210420002f01fa02210320002802fc022106200ca72101410a0c070b200541a10147200441ff017141a10147720d11200341ff017141dd00460d050c110b200541fb0047200441ff017141ef014772200341ff017141c10147200641044972720d10200041ac84043602682000200141086b36026c41a884042802002102410e0c050b200541c60047200441ff017141154772200341ff0171410647720d0f410f0c040b200341ff0171412247200541e90147722006412049200141c4006b41604f72720d0e20004190026a41d7840429000037030020004198026a41df8404290000370300200041a0026a41e784042d00003a0000200041a8016a41c784042d00003a0000200041cf840429000037038802200041bf84042900003703a00141b78404290000220e42388641af8404290000220c42088884210d41cb8404280000210641c984042f0000210341c884042d0000210441a884042d0000210941a984042f0000210841ab84042800002102200ca7210141030c030b200341ff017141c60147200541c90047720d0d200041d8026a200041e8006a103f20002802d8022202418180808078460d0d20003500dd02200041e3026a310000423086200041e1026a3300004220868484210d20002d00dc02210141050c020b200341ff017141c20147200541fb0047722006411f4d720d0c20014124462204450440200041c984043602682000200141256b36026c41c884042d000021020b20040d0c41014102200241ff017122014101461b410020011b22044102460d0c41b78404290000210e41af8404290000210c41ab8404280000210241a984042f0000210841a884042d00002109200041a8016a41c784042d00003a0000200041bf84042900003703a001200e423886200c42088884210d200ca7210141090c010b200041d8026a200041e8006a102320002802d8020d0b200041a8016a200041f8026a2d00003a0000200020002902f0023703a001200041e8026a290200220e42388620002902e002220c42088884210d20002802dc02210220002d00f902210420002f01fa02210320002802fc022106200ca72101410b0b2105200041406b200041a8016a2d00003a0000200041d0006a20004190026a290300370300200041d8006a20004198026a290300370300200041e0006a200041a0026a280200360200200041306a200e370300200020002903a00137033820002000290388023703482000200736026420002006360244200020033b0142200020043a004120002002360224200020083b0122200020093a0021200020053a002020002001ad42ff0183200d42088684220c3703282000428080013702dc02200041a484043602d8024100200041d8026a2201101620002802dc02220720002802e0022203490d0020002802d80221062000200720036b22073602d80220062003200320066a2206200110002103200720002802d8022208492003410f4f720d002003418582046a2d000022034103462003411047720d002000200836028c022000200636028802200120004188026a2203103720002802d8022209418080808078460d0020002902dc02211020012003103720002802d802220a418080808078460d00200028028c024110470d00200ca72106200d421888a72108200041206a220341047221012003410172210320002902dc02211141082107200028028802220b290000210f200041f7006a200b41086a290000220d4238883c0000200041f5006a200d4228883d0000200041f1006a200d4208883e00002000201037027c2000200936027820002011370388012000200a360284012000200f3c00682000200d423886200f42088884370069024002400240027f02400240024002400240024002400240024002400240024002400240200541016b0e0f0102030405060708090a0b0c000f10110b20004188026a2201102e200041086a10302000290308200029036885200041106a290300200041f0006a2903008584500440200120021042220741ff01714109460d0d0b41010c0d0b102f41ff01714105470d10200041d8026a2201410172200210140c1b0b102f41ff01714105470d0f200041d8026a22014101722002100f0c1a0b102f41ff01714105470d0e230041d0006b220124002001200041e8006a36020c200141106a200341c000100a200141306a10352100200141d0006a2400230041106b22012400200141a4840436020441a4840441003a000020014280808180103702082000200141046a10290c1b0b102f41ff01714105470d0d200041d8026a2201200028027c2000280280011034230041106b22002400200041808001360208200041a48404360204024041a58404027f2001280200220241818080807847044041a4840441003a000041002002418080808078460d011a41a5840441013a00002000410236020c20012802042001280208200041046a1036200028020c220141818001490d02000b41a4840441013a000041010b3a0000410221010b0c1b0b102f41ff01714105470d0c20004100200820024180808080784622011b3602800120004101200620011b36027c20004100200220011b3602780c180b102f41ff01714105470d0b2000200c3703682000200e3703700c170b102f41ff01714105470d0a200041d8026a2201200028028801200028028c0110332001200236020c230041106b22002400200041808001360208200041a48404360204024041a58404027f2001280200220241818080807847044041a4840441003a000041002002418080808078460d011a41a5840441013a00002000410236020c20012802042001280208200041046a22021036200128020c20021016200028020c220141818001490d02000b41a4840441013a000041010b3a0000410221010b0c180b102f41ff01714105470d0920004100200820024180808080784622011b36028c0120004101200620011b3602880120004100200220011b360284010c150b102f41ff01714105470d08200041b8016a2201200341186a290000370300200041b0016a2202200341106a290000370300200041a8016a2205200341086a290000370300200020032900003703a00120004188026a2203102e200041a0016a2206200310320d09200041f1026a200041a0026a290000370000200041e9026a20004198026a290000370000200041e1026a20004190026a29000037000020004181036a200529030037000020004189036a200229030037000020004191036a200129030037000020002000290088023700d902200020043a00d802200020002903a0013700f90220004280800137029801200041a484043602940120004194016a220141031020200141e58104101b2001200041d9026a2202101b2001200041f9026a2207101b2000280298012208200028029c012201490d082000280294012105200041003602ac032000200820016b3602a8032000200120056a3602a4032002200041a4036a2202101c20072002101c20002d00d8022002102920002802ac03220720002802a8034b0d082005200120002802a403200710020240200441ff01714504402000418c80043602a403200020063602ac03200020033602a8032000428080013702dc02200041a484043602d8022002200041d8026a102420002802e002220120002802dc024b0d0a20002802d802200110041a0c010b2000418c80043602a4032000200041a0016a3602ac03200020004188026a3602a8032000428080013702dc02200041a484043602d802200041a4036a200041d8026a102420002802e002220120002802dc024b0d0920002802d80222022001200120026a410010031a0b200041d8026a2201200041e8006a4128100a1a2001103c41002100410921010c100b102f41ff01714105470d072000200041e8006a3602a001200041a4016a20014124100a210520002802c4012103200041c8016a2204102e200041d8026a2003101420002d00d802450d09200041f1016a200041e2026a290000370000200041f9016a200041ea026a29000037000020004180026a200041f1026a290000370000200020002900da023700e901200020002d00d9023a00e801200041e8016a22062004103245044041062102200620041035450d0e0b200041f0026a4200370300200041e8026a4200370300200041e0026a4200370300200042003703d802410621022005200041d8026a220410320d0d41042102418080042003101a0d0d4180800420032005103b200041a0026a200041e0016a29000037030020004198026a200041d8016a29000037030020004190026a200041d0016a290000370300200041b0026a200141086a290200370300200041b8026a200141106a290200370300200041c0026a200141186a290200370300200020002900c80137038802200020012902003703a802200420004188026a41c000100a1a2000428080013702cc02200041a484043602c8022000200336029803200020004198036a3602d402200041c8026a220141041020200141c48104101b20012004101b2001200041f8026a2206101b200041a4036a22022001200041d4026a102c20002802a803220720002802ac032203490d0720002802a403210541002101200041003602ac032000200720036b3602a8032000200320056a3602a40320042002101c20062002101c2000280298032002101620002802ac03220220002802a8034b0d072005200320002802a403200210022004200041e8006a4128100a1a2004103c410921020c0e0b102f41ff01714105470d062000200041e8006a22023602d802200041dc026a20014124100a210120002802fc02210420004188026a2203102e2003200120041043220141ff0171410946047f200041d8026a220020024128100a1a2000103c41000541010b20011039000b102f41ff01714105470d052000200041e8006a22023602d802200041dc026a200141c400100a2101200041a0026a20004194036a29020037030020004198026a2000418c036a29020037030020004190026a20004184036a290200370300200020002902fc0237038802200120004188026a200028029c031043220141ff0171410946047f200041d8026a220020024128100a1a2000103c41000541010b20011039000b200041f5026a4200370000200041ed026a4200370000200041e5026a420037000020004186036a20004190026a2900003701002000418e036a20004198026a29000037010020004196036a200041a0026a290000370100200042003700dd0220002000290088023701fe02200041013a00fd02200041013a00dc02200020023602d802200041d8026a2201102b2001200041e8006a4128100a1a2001103c4109210741000b20071039000b102f41ff01714105470d02200041a0016a2204102e200041d8026a22012002101420002d00d802450d0520004191026a200041e2026a29000037000020004199026a200041ea026a290000370000200041a0026a200041f1026a290000370000200020002900da0237008902200020002d00d9023a008802410020004188026a200410310d061a200041f4026a2206200041b8016a290000370200200041ec026a2207200041b0016a290000370200200041e4026a2208200041a8016a290000370200200020002900a0013702dc022000418480043602d8022000428080013702a803200041a484043602a4032001200041a4036a2203102720002802a803220920002802ac032204490d0220002802a40321052000200920046b22093602a40320052004200420056a2205200310002104200920002802a403220a492004410f4f720d022004418582046a2d00002204410347044020044110470d032000200a3602a803200020053602a403200041186a2003101320002802180d03200028021c2209450d032006200041b8016a2900003702002007200041b0016a2900003702002008200041a8016a290000370200200020002900a0013702dc022000418480043602d8022000428080013702a803200041a484043602a40320012003102720002802a803220720002802ac032205490d0320002802a403210641002104200041003602ac032000200720056b3602a8032000200520066a3602a403200941016b2003101620002802ac03220320002802a8034b0d032006200520002802a403200310031a20021017200041f5026a200041b8016a290000370000200041ed026a200041b0016a290000370000200041e5026a200041a8016a29000037000020004186036a42003701002000418e036a420037010020004196036a4200370100200020002900a0013700dd02200042003701fe02200041013a00fd02200041013a00dc02200020023602d8022001102b2001200041e8006a4128100a1a2001103c410921010c080b41050c060b102f41ff01714105470d012000290368210d200041f0006a290300210e230041106b22012400200141a4840436020441a4840441003a00002001428080818010370208200d200e200141046a102a0c0e0b102f41ff01714105460d090b000b41012100410621010c060b410321020c030b41030b2101410121040b200420011039000b410121010b200120021039000b200020011039000b230041306b22012400200141186a200341086a290000370200200141206a200341106a290000370200200141286a200341186a2900003702002001200041e8006a36020c200120032900003702102001200141106a10112001280200210020012802042102200141306a2400230041106b22012400200141a4840436020441a4840441003a000020014280808180103702082002410020001b200141046a10160c030b103a000b200041003a00d802230041106b22002400200041808001360208200041a48404360204024020012d0000044041a484044181023b0100410221010c010b41a4840441003a00002000410136020c200141016a200041046a102d200028020c220141818001490d00000b0c020b200041d8026a2201200041e8006a4128100a1a2001103c410041091039000b200128020c2201418180014f0440000b0b41002001103e000b960101027f230041306b220224000240027f4102200110190d001a200241286a4200370300200241206a4200370300200241186a42003703002002420037031041062000200241106a10320d001a200241086a2000101102402002280208450440410121030c010b200228020c41016a2203450d020b2000200310154188800420012000103b41090b2103200241306a240020030f0b000bc10401057f230041c0016b22032400200341106a2205102e200341d0006a2206200210140240024020032d00500440200341396a200341da006a290000370000200341c1006a200341e2006a290000370000200341c8006a200341e9006a220729000037000020032003290052370031200320032d00513a0030200341e8006a4200370300200341e0006a4200370300200341d8006a42003703002003420037035041012104200520061031450d0202402005200341306a10320d002003419f016a2002100f2007200341286a290000370000200341e1006a200341206a290000370000200341d9006a200341186a29000037000020032003290010370051200341013a005020032d009f010440200341a0016a200341d1006a10320d010b200341306a200341106a1035450d030b41002104200341306a200010310d0241808004200210184103210420021019450d02200341086a200010112003280208450440410521040c030b200328020c2204450d012000200441016b101520021017200120021042220441ff01714109470d02200341dd006a200041086a290000370000200341e5006a200041106a290000370000200341ed006a200041186a290000370000200341fe006a200141086a29000037010020034186016a200141106a2900003701002003418e016a200141186a290000370100200341013a0054200341013a0075200320002900003700552003200129000037017620032002360250200341d0006a102b410921040c020b410321040c010b000b200341c0016a240020040bb70101027f230041406a2200240002400240102f41ff01714105470d0020004180800136020841a48404200041086a100120002802082201418180014f0d00200141044f044041a48404280200419bddf6f405460d020b103a000b000b200041346a4190800441d0001034200041186a41e0800441c20010342000412c6a2000413c6a280200360200200042003703102000420037030820002000290234370224200041086a103c41a4840441003b010041004102103e000b3701017f230041306b220324002003410f6a20022001101020032d000f4102460440000b20002003410f6a4121100a1a200341306a24000b0bd7030200418080040b94036076894df29d37b59edb16ed334398ad68747470733a2f2f676174657761792e70696e6174612e636c6f75642f697066732f516d5171504575616b373632417250794d5957754d7573574d61556d754e6f784b5438616b613844686a55504e39697066733a2f2f6261666b726569637468706964796f33677a6e70337575657a767765697572377863626f357163776777337834746575693270736f7178786267710101abfe3b4a94cbec268e6df12c117430904e0cd2d9cea73cfd1c023dfa83f46c018ab12ba91829833deb94db202a63546b5b65792283cef47282cd7f8ded9dcf3e01d774bd2aa72117f7287e75352336b69c11c6398b418daa34c89711939cfd45bb100102030405060708090a0b0c0d0e01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010041d683040b33020202020202020202020202020202020202020202020202020202020202030303030303030303030303030303030404040404";


const code = Binary.fromBytes(new Uint8Array(Buffer.from(wasmBlob, 'hex')));


// Takes in the constructor name (TS suggests the ones available)
const erc721Constructor = erc721Client.constructor("new")

// Encode the data for that constructor, also with full TS support
const constructorData = erc721Constructor.encode({
})

// Generate a random salt - For demo purposes using a hardcoded ones.
const generateRandomSalt = () => {
  const array = new Uint8Array(32); // 32 bytes of randomness
  crypto.getRandomValues(array);
  return Binary.fromBytes(array);
}
const salt = generateRandomSalt();


// Perform the call to the RuntimeAPI to dry-run a contract deployment.
const responseDeploy = await typedApi.apis.ContractsApi.instantiate(
  myAccount, // Origin
  0n, // Value
  undefined, // GasLimit
  undefined, // StorageDepositLimit
  Enum("Upload", code),
  constructorData,
  salt,
)


// Deploy smart contract 
console.log(responseDeploy);
if (responseDeploy.result.success) {
  contractAddress = responseDeploy.result.value.account_id
  console.log("Resulting address", contractAddress)
} else {
  console.log("Deploy dry run failed")
}


const resDeploy = await typedApi.tx.Contracts.instantiate_with_code({

  value: 0n, // Value
  gas_limit: {
    ref_time: 177922581n,
    proof_size: 16689n
  }, // GasLimit
  storage_deposit_limit: undefined, // StorageDepositLimit
  code: code,
  data: constructorData,
  salt: salt
}).signAndSubmit(buildAccount());

console.log("Deploy result", resDeploy);

// Dry-run set price mint 



const setPrice = erc721Client.message("set_mint_fee")
// Encode the data for that message, also with full TS support
const setPriceData = setPrice.encode({
  // 0.1 TAZERO with 12 decimals token 
  fee_amount: 100000000000n
})
const responseSetPrice = await typedApi.apis.ContractsApi.call(
  myAccount, // Origin
  contractAddress, // Contract address
  0n, // Value
  undefined, // GasLimit
  undefined, // StorageDepositLimit
  setPriceData,
)

console.log(responseSetPrice);
if (responseSetPrice.result.success) {
  // Events come in decoded and typed
  const events = erc721Client.event.filter(contractAddress, responseSetPrice.events)
  console.log("events", events)

  // The response message can also be decoded, and it's also fully typed
  const responseMessage = setPrice.decode(responseSetPrice.result.value)
  console.log("Result response Set Price", responseMessage)
} else {
  console.log("Set price dry run failed")
}


const resSetPrice = await typedApi.tx.Contracts.call({
  dest: MultiAddress.Id(contractAddress),
  value: 0n, // Value
  gas_limit: {
    ref_time: 979371156n,
    proof_size: 51005n
  }, // GasLimit
  storage_deposit_limit: undefined, // StorageDepositLimit
  data: setPriceData,
}

).signAndSubmit(buildAccount());

console.log("Set price result", resSetPrice);




// Mint token 

const mint = erc721Client.message("mint")
// Encode the data for that message, also with full TS support
const messageMint = mint.encode({
  id: 0
})
const responseMint = await typedApi.apis.ContractsApi.call(
  myAccount, // Origin
  contractAddress, // Contract address
  100000000000n, // Value
  undefined, // GasLimit
  undefined, // StorageDepositLimit
  messageMint,
)

if (responseMint.result.success) {
  // Events come in decoded and typed
  const events = erc721Client.event.filter(contractAddress, responseMint.events)
  console.log("events", events)

  // The response message can also be decoded, and it's also fully typed
  const responseMessage = mint.decode(responseMint.result.value)
  console.log("Result response Mint", responseMessage)
} else {
  console.log("Mint dry run failed")
}


const resMint = await typedApi.tx.Contracts.call({
  dest: MultiAddress.Id(contractAddress),

  value: 100000000000n, // Value
  gas_limit: {
    ref_time: 2152940845n,
    proof_size: 71005n
  }, // GasLimit
  storage_deposit_limit: undefined, // StorageDepositLimit
  data: messageMint,
}

).signAndSubmit(buildAccount());

console.log("Mint result", resMint);


// remark 
const { api, disconnect } = magicApi("ahpas");



const remark = makeRemark({ api }, `task_erc721/${myAccount}`);


const res = await submit([remark]);

console.log(res);








